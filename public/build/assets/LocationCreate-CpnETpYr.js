import{r as c,j as e,W as U}from"./app-Dm8cIE4T.js";import{C as K,a as T,b as z,d as X,e as W}from"./card-BcIbXjuy.js";import{I as v}from"./input-CBzUmVr_.js";import{B as q}from"./button-DgGlTW6a.js";import{L as u}from"./label-Cskz7mPN.js";import{A as l,a as d}from"./alert-DHtm6IX7.js";import{u as $}from"./index-C_uji-SS.js";import{c as G,u as J,a as P,P as Q}from"./index-DKrXWNRO.js";import{u as V,a as Y}from"./index-X_rSZWSA.js";import{P as F}from"./index-BnBCp9FI.js";import{c as L}from"./utils-BM_CldAA.js";import{C as Z}from"./react-icons.esm-CsjtdSIY.js";import{L as ee}from"./loading-screen-D__ngmPk.js";import{c as re}from"./createLucideIcon-Bdj_7l1A.js";import{L as I}from"./loader-circle-Bkkx-D_Q.js";import"./proxy-BqRsr-Q7.js";/**
 * @license lucide-react v0.454.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=re("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);var E="Checkbox",[se,Re]=G(E),[te,ne]=se(E),_=c.forwardRef((t,h)=>{const{__scopeCheckbox:n,name:j,checked:g,defaultChecked:o,required:C,disabled:p,value:s="on",onCheckedChange:i,form:b,...k}=t,[a,R]=c.useState(null),w=$(h,m=>R(m)),r=c.useRef(!1),x=a?b||!!a.closest("form"):!0,[f=!1,S]=J({prop:g,defaultProp:o,onChange:i}),H=c.useRef(f);return c.useEffect(()=>{const m=a==null?void 0:a.form;if(m){const N=()=>S(H.current);return m.addEventListener("reset",N),()=>m.removeEventListener("reset",N)}},[a,S]),e.jsxs(te,{scope:n,state:f,disabled:p,children:[e.jsx(F.button,{type:"button",role:"checkbox","aria-checked":y(f)?"mixed":f,"aria-required":C,"data-state":M(f),"data-disabled":p?"":void 0,disabled:p,value:s,...k,ref:w,onKeyDown:P(t.onKeyDown,m=>{m.key==="Enter"&&m.preventDefault()}),onClick:P(t.onClick,m=>{S(N=>y(N)?!0:!N),x&&(r.current=m.isPropagationStopped(),r.current||m.stopPropagation())})}),x&&e.jsx(ie,{control:a,bubbles:!r.current,name:j,value:s,checked:f,required:C,disabled:p,form:b,style:{transform:"translateX(-100%)"},defaultChecked:y(o)?!1:o})]})});_.displayName=E;var D="CheckboxIndicator",A=c.forwardRef((t,h)=>{const{__scopeCheckbox:n,forceMount:j,...g}=t,o=ne(D,n);return e.jsx(Q,{present:j||y(o.state)||o.state===!0,children:e.jsx(F.span,{"data-state":M(o.state),"data-disabled":o.disabled?"":void 0,...g,ref:h,style:{pointerEvents:"none",...t.style}})})});A.displayName=D;var ie=t=>{const{control:h,checked:n,bubbles:j=!0,defaultChecked:g,...o}=t,C=c.useRef(null),p=V(n),s=Y(h);c.useEffect(()=>{const b=C.current,k=window.HTMLInputElement.prototype,R=Object.getOwnPropertyDescriptor(k,"checked").set;if(p!==n&&R){const w=new Event("click",{bubbles:j});b.indeterminate=y(n),R.call(b,y(n)?!1:n),b.dispatchEvent(w)}},[p,n,j]);const i=c.useRef(y(n)?!1:n);return e.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:g??i.current,...o,tabIndex:-1,ref:C,style:{...t.style,...s,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function y(t){return t==="indeterminate"}function M(t){return y(t)?"indeterminate":t?"checked":"unchecked"}var O=_,ce=A;const B=c.forwardRef(({className:t,...h},n)=>e.jsx(O,{ref:n,className:L("peer h-4 w-4 shrink-0 rounded-sm border border-primary shadow focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",t),...h,children:e.jsx(ce,{className:L("flex items-center justify-center text-current"),children:e.jsx(Z,{className:"h-4 w-4"})})}));B.displayName=O.displayName;const we=()=>{const[t,h]=c.useState(""),[n,j]=c.useState([]),[g,o]=c.useState(!0),[C,p]=c.useState(null),{data:s,setData:i,post:b,processing:k,errors:a}=U({name:"",location:"",servers:0,flag:"",maxservers:0,latencyurl:"",requiredRank:"",maintenance:!1,requiredSubscriptions:[],coinRenewal:"",platform:"",platform_settings:""});c.useEffect(()=>{(async()=>{try{const f=await(await fetch("/admin/api/plans")).json();f.statusCode===200&&f.plans?j(f.plans):p("Failed to load plans")}catch(x){p("Error fetching plans: "+x.message)}finally{o(!1)}})()},[]);const R=()=>({name:s.name,location:s.location,servers:s.servers,flag:s.flag,maxservers:s.maxservers,latencyurl:s.latencyurl,requiredRank:s.requiredRank,maintenance:s.maintenance,requiredSubscriptions:s.requiredSubscriptions,coinRenewal:s.coinRenewal,platform:s.platform,platform_settings:s.platform_settings}),w=r=>{r.preventDefault();const x=R();//console.log ("Submitting location data:",x),b(route("locations.store"),x)};return e.jsx("div",{className:"max-w-2xl mx-auto py-8",children:e.jsxs(K,{children:[e.jsx(T,{children:e.jsx(z,{children:"Create New Location"})}),e.jsx(X,{children:e.jsxs("form",{onSubmit:w,className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"name",children:"Location Name"}),e.jsx(v,{id:"name",value:s.name,onChange:r=>{i({...s,name:r.target.value,location:r.target.value})},placeholder:"Enter location name"}),a.name&&e.jsxs(l,{variant:"destructive",children:[e.jsx(ae,{className:"h-4 w-4"}),e.jsx(d,{children:a.name})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"servers",children:"Current Servers"}),e.jsx(v,{id:"servers",type:"number",value:s.servers,onChange:r=>i("servers",parseInt(r.target.value)),min:"0"}),a.servers&&e.jsx(l,{variant:"destructive",children:e.jsx(d,{children:a.servers})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"maxservers",children:"Maximum Servers"}),e.jsx(v,{id:"maxservers",type:"number",value:s.maxservers,onChange:r=>i("maxservers",parseInt(r.target.value)),min:"0"}),a.maxservers&&e.jsx(l,{variant:"destructive",children:e.jsx(d,{children:a.maxservers})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"flag",children:"Flag Image URL"}),e.jsx(v,{id:"flag",value:s.flag,onChange:r=>{i("flag",r.target.value),h(r.target.value)},placeholder:"Enter flag image URL"}),a.flag&&e.jsx(l,{variant:"destructive",children:e.jsx(d,{children:a.flag})}),t&&e.jsx("div",{className:"mt-2",children:e.jsx("img",{src:t,alt:"Flag Preview",className:"w-32 h-32 object-contain border rounded-md",onError:()=>h("")})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"latencyurl",children:"Latency URL"}),e.jsx(v,{id:"latencyurl",value:s.latencyurl,onChange:r=>i("latencyurl",r.target.value),placeholder:"Enter latency URL"}),a.latencyurl&&e.jsx(l,{variant:"destructive",children:e.jsx(d,{children:a.latencyurl})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"requiredRank",children:"Required Rank"}),e.jsx(v,{id:"requiredRank",value:s.requiredRank,onChange:r=>i("requiredRank",r.target.value),placeholder:"Enter required rank"}),a.requiredRank&&e.jsx(l,{variant:"destructive",children:e.jsx(d,{children:a.requiredRank})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(B,{id:"maintenance",checked:s.maintenance,onCheckedChange:r=>i("maintenance",r)}),e.jsx(u,{htmlFor:"maintenance",children:"Maintenance Mode"})]}),a.maintenance&&e.jsx(l,{variant:"destructive",children:e.jsx(d,{children:a.maintenance})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"requiredSubscriptions",children:"Required Subscriptions"}),g?e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(I,{className:"h-4 w-4 animate-spin"}),e.jsx("span",{children:"Loading plans..."})]}):C?e.jsx(l,{variant:"destructive",children:e.jsx(d,{children:C})}):e.jsx("select",{id:"requiredSubscriptions",value:s.requiredSubscriptions,onChange:r=>i("requiredSubscriptions",Array.from(r.target.selectedOptions,x=>x.value)),multiple:!0,className:"w-full rounded-md border border-input bg-background px-3 py-2",children:n.map(r=>e.jsx("option",{value:r.id,children:r.name},r.id))}),a.requiredSubscriptions&&e.jsx(l,{variant:"destructive",children:e.jsx(d,{children:a.requiredSubscriptions})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"coinRenewal",children:"Coin Renewal (Optional)"}),e.jsx(v,{id:"coinRenewal",value:s.coinRenewal,onChange:r=>i("coinRenewal",r.target.value),placeholder:"Enter coin renewal details"}),a.coinRenewal&&e.jsx(l,{variant:"destructive",children:e.jsx(d,{children:a.coinRenewal})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"platform",children:"Platform"}),e.jsx(v,{id:"platform",type:"number",value:s.platform,onChange:r=>i("platform",parseInt(r.target.value)),min:"0"}),a.platform&&e.jsx(l,{variant:"destructive",children:e.jsx(d,{children:a.platform})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"platform_settings",children:"Platform Settings (Optional)"}),e.jsx(v,{id:"platform_settings",value:s.platform_settings,onChange:r=>i("platform_settings",r.target.value),placeholder:"Enter platform settings"}),a.platform_settings&&e.jsx(l,{variant:"destructive",children:e.jsx(d,{children:a.platform_settings})})]})]})}),e.jsxs(W,{className:"flex justify-end space-x-4",children:[e.jsx(q,{variant:"outline",onClick:()=>window.history.back(),children:"Cancel"}),e.jsx(q,{onClick:w,disabled:k||g,children:k?e.jsxs(e.Fragment,{children:[e.jsx(ee,{}),e.jsx(I,{className:"mr-2 h-4 w-4 animate-spin"}),"Creating..."]}):"Create Location"})]})]})})};export{we as default};
