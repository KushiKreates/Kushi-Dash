import{r as t,q as g,W as I,j as e,b as j}from"./app-Dm8cIE4T.js";import"./card-BcIbXjuy.js";import{A as d,a as m}from"./alert-DHtm6IX7.js";import{L as l}from"./label-Cskz7mPN.js";import{I as u}from"./input-CBzUmVr_.js";import{B as k}from"./button-DgGlTW6a.js";import{S as A}from"./switch-BjouQe5B.js";import{D as U,a as _,b as B,c as O}from"./dialog-B6xtXYzy.js";import{L as $}from"./loader-circle-Bkkx-D_Q.js";import"./utils-BM_CldAA.js";import"./index-BnBCp9FI.js";import"./index-C_uji-SS.js";import"./index-DKrXWNRO.js";import"./index-X_rSZWSA.js";import"./index-DLTLx8j3.js";import"./index-C_FO5VxW.js";import"./react-icons.esm-CsjtdSIY.js";import"./createLucideIcon-Bdj_7l1A.js";const oe=()=>{var f;const[v,S]=t.useState(!0),[y,L]=t.useState([]),[b,q]=t.useState(!0),[N,C]=t.useState(null),[E,p]=t.useState(!1),{location:o,flash:F}=g().props,w=o.id,h=g().props.location.id,{data:i,setData:x,put:D,errors:n}=I({name:"",location:"",servers:0,flag:"",maxservers:0,latencyurl:"",requiredRank:"",maintenance:!1,requiredSubscriptions:[],platform:"",platform_settings:null});t.useEffect(()=>{var a;const s=((a=o==null?void 0:o.flash)==null?void 0:a.success)??null;p(!!s)},[(f=o==null?void 0:o.flash)==null?void 0:f.success]);const M=()=>e.jsx(U,{open:E,onOpenChange:p,children:e.jsxs(_,{children:[e.jsx(B,{children:e.jsx(O,{children:"Success"})}),e.jsx(d,{children:e.jsx(m,{children:F.success})})]})});t.useEffect(()=>{(async()=>{try{const r=(await j.get(`/admin/api/locations/${h}`)).data.location;x(R=>({...R,name:r.name,location:r.location,servers:r.servers,flag:r.flag,maxservers:r.maxservers,latencyurl:r.latencyurl,requiredRank:r.requiredRank,maintenance:r.maintenance,requiredSubscriptions:r.requiredSubscriptions,platform:r.platform,platform_settings:r.platform_settings}))}catch(a){console.error("Error fetching location:",a)}finally{S(!1)}})()},[h]),t.useEffect(()=>{(async()=>{try{const a=await j.get("/admin/plans");L(a.data.plans||[])}catch{C("Failed to load plans.")}finally{q(!1)}})()},[]);const P=s=>{s.preventDefault(),D(`/admin/locations/${w}`,{data:i,onSuccess:()=>{//console.log ("Location updated successfully"),p(!0)},onError:a=>{console.error("Error updating location:",a)}})},c=(s,a)=>{x(r=>({...r,[s]:a}))};return v?e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[e.jsx($,{className:"h-6 w-6 animate-spin"}),e.jsx("span",{children:"Loading location..."})]}):e.jsxs(e.Fragment,{children:[e.jsxs("form",{onSubmit:P,className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"name",children:"Name"}),e.jsx(u,{id:"name",value:i.name,onChange:s=>c("name",s.target.value),placeholder:"Location name"}),n.name&&e.jsx(d,{variant:"destructive",children:e.jsx(m,{children:n.name})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"location",children:"Location"}),e.jsx(u,{id:"location",value:i.location,onChange:s=>c("location",s.target.value),placeholder:"Physical location"}),n.location&&e.jsx(d,{variant:"destructive",children:e.jsx(m,{children:n.location})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"flag",children:"Flag URL"}),e.jsx(u,{id:"flag",value:i.flag,onChange:s=>c("flag",s.target.value),placeholder:"Flag image URL"}),n.flag&&e.jsx(d,{variant:"destructive",children:e.jsx(m,{children:n.flag})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"maxservers",children:"Max Servers"}),e.jsx(u,{id:"maxservers",type:"number",value:i.maxservers,onChange:s=>c("maxservers",parseInt(s.target.value)),placeholder:"Maximum servers allowed"}),n.maxservers&&e.jsx(d,{variant:"destructive",children:e.jsx(m,{children:n.maxservers})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"maintenance",children:"Maintenance Mode"}),e.jsx(A,{id:"maintenance",checked:i.maintenance,onCheckedChange:s=>c("maintenance",s)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"requiredSubscriptions",children:"Required Subscriptions"}),!b&&!N&&e.jsx("select",{id:"requiredSubscriptions",value:i.requiredSubscriptions,onChange:s=>c("requiredSubscriptions",Array.from(s.target.selectedOptions,a=>a.value)),multiple:!0,className:"w-full rounded-md border px-3 py-2",children:y.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))})]}),e.jsx(k,{type:"submit",className:"w-full",children:"Update Location"})]}),e.jsx(M,{})]})};export{oe as default};
